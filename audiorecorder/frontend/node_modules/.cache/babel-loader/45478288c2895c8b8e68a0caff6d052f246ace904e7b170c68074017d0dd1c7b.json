{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Streamlit,withStreamlitConnection}from\"streamlit-component-lib\";import{AudioRecorder as AudioRecorderVisualiser,useAudioRecorder}from'@theevann/react-audio-voice-recorder';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function BlobToDataURL(blob){debugger;return new Promise(resolve=>{const reader=new FileReader();reader.onloadend=()=>resolve(reader.result);reader.readAsDataURL(blob);});}function AudioRecorder(props){var _props$theme,_props$theme2,_props$theme3,_props$theme4,_props$theme5,_props$theme6,_props$theme7,_props$theme8,_props$theme9,_props$theme10;const[isHoveredStart,setIsHoveredStart]=useState(false);const[isHoveredStop,setIsHoveredStop]=useState(false);const recorderControls=useAudioRecorder();const useAudioRecorderVisualiser=props.args.startPrompt===\"\"&&props.args.stopPrompt===\"\";const onRecordingComplete=async blob=>{const audioDataStr=(await BlobToDataURL(blob)).replace(/^data:.+?base64,/,\"\");Streamlit.setComponentValue(audioDataStr);};useEffect(()=>{// Component did mount\nStreamlit.setFrameHeight();// mimic componentDidUpdate if necessary\nconst resizeListener=()=>{Streamlit.setFrameHeight();};window.addEventListener('resize',resizeListener);// Component will unmount\nreturn()=>{window.removeEventListener('resize',resizeListener);};},[]);useEffect(()=>{if(!useAudioRecorderVisualiser&&recorderControls.recordingBlob){onRecordingComplete(recorderControls.recordingBlob);}},[recorderControls.recordingBlob,useAudioRecorderVisualiser]);return!useAudioRecorderVisualiser?/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{if(recorderControls.isRecording){recorderControls.togglePauseResume();}else{recorderControls.startRecording();}},disabled:props.disabled,className:\"btn btn-outline-secondary\",style:{...{display:!recorderControls.isRecording||props.args.pausePrompt!==\"\"?\"inline-block\":\"none\",marginBottom:\"1px\",marginRight:\"10px\",color:(_props$theme=props.theme)===null||_props$theme===void 0?void 0:_props$theme.textColor,backgroundColor:isHoveredStart?(_props$theme2=props.theme)===null||_props$theme2===void 0?void 0:_props$theme2.secondaryBackgroundColor:(_props$theme3=props.theme)===null||_props$theme3===void 0?void 0:_props$theme3.backgroundColor,borderColor:(_props$theme4=props.theme)===null||_props$theme4===void 0?void 0:_props$theme4.textColor,fontFamily:(_props$theme5=props.theme)===null||_props$theme5===void 0?void 0:_props$theme5.font},...props.args.customStyle,...(recorderControls.isRecording&&!recorderControls.isPaused?props.args.pauseStyle:props.args.startStyle)},onMouseEnter:()=>setIsHoveredStart(true),onMouseLeave:()=>setIsHoveredStart(false),children:recorderControls.isRecording&&!recorderControls.isPaused?props.args.pausePrompt:props.args.startPrompt}),/*#__PURE__*/_jsx(\"button\",{onClick:recorderControls.stopRecording,disabled:props.disabled||!recorderControls.isRecording&&!recorderControls.isPaused,className:\"btn btn-outline-secondary\",style:{...{display:recorderControls.isRecording||recorderControls.isPaused?\"inline-block\":\"none\",marginBottom:\"1px\",color:(_props$theme6=props.theme)===null||_props$theme6===void 0?void 0:_props$theme6.textColor,backgroundColor:isHoveredStop?(_props$theme7=props.theme)===null||_props$theme7===void 0?void 0:_props$theme7.secondaryBackgroundColor:(_props$theme8=props.theme)===null||_props$theme8===void 0?void 0:_props$theme8.backgroundColor,borderColor:(_props$theme9=props.theme)===null||_props$theme9===void 0?void 0:_props$theme9.textColor,fontFamily:(_props$theme10=props.theme)===null||_props$theme10===void 0?void 0:_props$theme10.font},...props.args.customStyle,...props.args.stopStyle},onMouseEnter:()=>setIsHoveredStop(true),onMouseLeave:()=>setIsHoveredStop(false),children:props.args.stopPrompt})]}):/*#__PURE__*/_jsx(\"div\",{style:{padding:\"5px\"},children:/*#__PURE__*/_jsx(AudioRecorderVisualiser,{onRecordingComplete:onRecordingComplete,recorderControls:recorderControls,showVisualizer:props.args.showVisualizer})});}export default withStreamlitConnection(AudioRecorder);","map":{"version":3,"names":["React","useEffect","useState","Streamlit","withStreamlitConnection","AudioRecorder","AudioRecorderVisualiser","useAudioRecorder","jsx","_jsx","jsxs","_jsxs","BlobToDataURL","blob","Promise","resolve","reader","FileReader","onloadend","result","readAsDataURL","props","_props$theme","_props$theme2","_props$theme3","_props$theme4","_props$theme5","_props$theme6","_props$theme7","_props$theme8","_props$theme9","_props$theme10","isHoveredStart","setIsHoveredStart","isHoveredStop","setIsHoveredStop","recorderControls","useAudioRecorderVisualiser","args","startPrompt","stopPrompt","onRecordingComplete","audioDataStr","replace","setComponentValue","setFrameHeight","resizeListener","window","addEventListener","removeEventListener","recordingBlob","children","onClick","isRecording","togglePauseResume","startRecording","disabled","className","style","display","pausePrompt","marginBottom","marginRight","color","theme","textColor","backgroundColor","secondaryBackgroundColor","borderColor","fontFamily","font","customStyle","isPaused","pauseStyle","startStyle","onMouseEnter","onMouseLeave","stopRecording","stopStyle","padding","showVisualizer"],"sources":["/Users/pilarhernandez/Documents/Mbit/TFM/v2/audiorecorder/frontend/src/AudioRecorder.tsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\"\nimport {\n  Streamlit,\n  withStreamlitConnection,\n} from \"streamlit-component-lib\"\nimport { AudioRecorder as AudioRecorderVisualiser, useAudioRecorder } from '@theevann/react-audio-voice-recorder';\n\n\nfunction BlobToDataURL(blob: Blob): Promise<string>{\n  debugger;\n  return new Promise(resolve => {\n    const reader = new FileReader();\n    reader.onloadend = () => resolve(reader.result as string);\n    reader.readAsDataURL(blob);\n  });\n}\n\nfunction AudioRecorder(props: any) {\n  const [isHoveredStart, setIsHoveredStart] = useState(false);\n  const [isHoveredStop, setIsHoveredStop] = useState(false);\n\n  const recorderControls = useAudioRecorder();\n\n  const useAudioRecorderVisualiser = props.args.startPrompt === \"\" && props.args.stopPrompt === \"\";\n\n  const onRecordingComplete = async (blob: Blob) => {\n    const audioDataStr = (await BlobToDataURL(blob)).replace(/^data:.+?base64,/, \"\");\n    Streamlit.setComponentValue(audioDataStr);\n  };\n\n  useEffect(() => {\n    // Component did mount\n    Streamlit.setFrameHeight();\n\n    // mimic componentDidUpdate if necessary\n    const resizeListener = () => {\n      Streamlit.setFrameHeight();\n    };\n\n    window.addEventListener('resize', resizeListener);\n\n    // Component will unmount\n    return () => { window.removeEventListener('resize', resizeListener); };\n  }, []);\n\n  useEffect(() => {\n    if (!useAudioRecorderVisualiser && recorderControls.recordingBlob) {\n      onRecordingComplete(recorderControls.recordingBlob);\n    }\n  }, [recorderControls.recordingBlob, useAudioRecorderVisualiser]);\n\n\n  return !useAudioRecorderVisualiser ? (\n    <span>\n      <button\n        onClick={() => {\n          if (recorderControls.isRecording) {\n            recorderControls.togglePauseResume();\n          } else {\n            recorderControls.startRecording();\n          }\n        }}\n        disabled={props.disabled}\n        className=\"btn btn-outline-secondary\"\n        style={{\n          ...{\n            display: (!recorderControls.isRecording || props.args.pausePrompt !== \"\") ? \"inline-block\" : \"none\",\n            marginBottom: \"1px\",\n            marginRight: \"10px\",\n            color: props.theme?.textColor,\n            backgroundColor: isHoveredStart ? props.theme?.secondaryBackgroundColor : props.theme?.backgroundColor,\n            borderColor: props.theme?.textColor,\n            fontFamily: props.theme?.font,\n          },\n          ...props.args.customStyle,\n          ...(recorderControls.isRecording && !recorderControls.isPaused ? props.args.pauseStyle : props.args.startStyle),\n        }}\n        onMouseEnter={() => setIsHoveredStart(true)}\n        onMouseLeave={() => setIsHoveredStart(false)}\n      >\n        {recorderControls.isRecording && !recorderControls.isPaused ? props.args.pausePrompt : props.args.startPrompt}\n      </button>\n      <button\n        onClick={recorderControls.stopRecording}\n        disabled={props.disabled || (!recorderControls.isRecording && !recorderControls.isPaused)}\n        className=\"btn btn-outline-secondary\"\n        style={{\n          ...{\n            display: (recorderControls.isRecording || recorderControls.isPaused) ? \"inline-block\" : \"none\",\n            marginBottom: \"1px\",\n            color: props.theme?.textColor,\n            backgroundColor: isHoveredStop ? props.theme?.secondaryBackgroundColor : props.theme?.backgroundColor,\n            borderColor: props.theme?.textColor,\n            fontFamily: props.theme?.font,\n          },\n          ...props.args.customStyle,\n          ...props.args.stopStyle,\n        }}\n        onMouseEnter={() => setIsHoveredStop(true)}\n        onMouseLeave={() => setIsHoveredStop(false)}\n      >\n        {props.args.stopPrompt}\n      </button>\n    </span>\n  ) : (\n      <div style={{ padding: \"5px\" }}>\n        <AudioRecorderVisualiser\n          onRecordingComplete={onRecordingComplete}\n          recorderControls={recorderControls}\n          showVisualizer={props.args.showVisualizer}\n        />\n      </div>\n  );\n}\n\nexport default withStreamlitConnection(AudioRecorder);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}